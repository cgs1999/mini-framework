$.namespace("Mo.SubFrame"),Mo.SubFrame={init:function(){this.isIframe(),this.setSize(),this.initEvent(),Mo.SubFrame.controller.init()},isIframe:function(){return top.location===self.location?!1:!0},initEvent:function(){var i=this;$(window).resize(function(){i.setSize()})},getWindowSize:function(){var i=$(window).width(),t=$(window).height();return{w:i,h:t}},setSize:function(){if(!this.isEasyUI()){var i=this.getWindowSize(),t=$(".detail-btn").outerHeight();$(".detail-body").height(i.h-t)}},isEasyUI:function(){return $(".easyui-layout")[0]},getPageSize:function(){return 14}},Mo.SubFrame.controller={superFrame:window.parent&&window.parent.Mo.Frame.controller,init:function(){this.initUrlFilter()},initUrlFilter:function(){this.mainUrlFilter(),this.detailUrlFilter()},mainUrlFilter:function(){var i=this.superFrame;$(document).on("click","a[target='"+i.mainFrameTag+"']",function(){var t=$(this).attr("href");return t&&i.setMainFrame(t),!1})},detailUrlFilter:function(){var i=this;$(document).on("click","a[target='"+this.detailFrameTag+"']",function(){var t=$(this).attr("href");return t&&i.setDetailFrame(t),!1})},setMainFrame:function(i){this.superFrame.setMainFrame(i)},setDetailFrame:function(i,t,e){this.superFrame.setDetailFrame(i,t,e)},showDetail:function(i,t){this.superFrame.showDetail(i,t)},hideDetail:function(){this.superFrame.hideDetail()},setDetailSize:function(i,t){this.superFrame.setDetailSize(i,t)},getMainFrame:function(){return this.superFrame.getMainFrame()},getDetailFrame:function(){return this.superFrame.getMainFrame()},callMainFrameFn:function(i){this.superFrame.callMainFrameFn(i)},callDetailFrameFn:function(i){this.superFrame.callDetailFrameFn(i)}},$.namespace("Mo.gridDetail"),Mo.gridDetail={baseUrl:"",gridPageSize:Mo.SubFrame.getPageSize(),datagridId:"#data-grid",datagridOptions:null,treegridId:"#data-grid",treegridOptions:null,treeId:"#mytree",treeOptions:null,init:function(i){this.initOptions(i),this.initPage(),this.initHint(".input-text")},initOptions:function(i){this.initDefaultDatagridOptions(i),this.initDefaultTreegridOptions(i),this.initDefaultTreeOptions(i),$.extend(!0,this,i)},initDefaultDatagridOptions:function(i){if(i&&i.datagridOptions){var t={datagridOptions:{idField:"id",toolbar:"#tb",rownumbers:!0,striped:!1,singleSelect:!0,border:!1,fit:!0,fitColumns:!0,showHeader:!0,pagination:!0,pageSize:this.gridPageSize,pageList:[this.gridPageSize],loadMsg:"正在加载，请稍候...",onBeforeLoad:function(i){i.start=(i.page-1)*i.rows,i.limit=i.rows},onClickRow:function(i,t){var e=$(this).datagrid("options").idField;Mo.gridDetail.doOpen(t[e])}}};$.extend(!0,this,t)}},initDefaultTreegridOptions:function(i){if(i&&i.treegridOptions){var t={treegridOptions:{idField:"id",toolbar:"#tb",rownumbers:!0,striped:!1,singleSelect:!0,border:!1,fit:!0,fitColumns:!0,showHeader:!0,loadMsg:"正在加载，请稍候...",onClickRow:function(i){var t=$(this).treegrid("options").idField;Mo.gridDetail.doOpen(i[t])}}};$.extend(!0,this,t)}},initDefaultTreeOptions:function(i){if(i&&i.treeOptions){var t={treeOptions:{formatter:function(i){var t=i.text;return t}}};$.extend(!0,this,t)}},initPage:function(){this.initTree(),this.initDatagrid(),this.initTreegrid()},initTree:function(){this.treeOptions&&$(this.treeId).tree(this.treeOptions)},initDatagrid:function(){this.datagridOptions&&($(this.datagridId).datagrid(this.datagridOptions),this.datagridOptions.pagination&&this.initPagination($(this.datagridId).datagrid("getPager")))},initTreegrid:function(){this.treegridOptions&&($(this.treegridId).treegrid(this.treegridOptions),this.treegridOptions.pagination&&this.initPagination($(this.treegridId).treegrid("getPager")))},initPagination:function(i){i.pagination({layout:["manual","prev","next"],displayMsg:"",beforePageText:"",afterPageText:"/ {pages}"})},initHint:function(i){$(i).each(function(){$(this).val($(this).attr("mo-hint"))}).blur(function(){$(this).removeClass("active");var i=$(this).val(),t=$(this).attr("mo-hint");""==i&&$(this).val(t)}).focus(function(){$(this).addClass("active");var i=$(this).val(),t=$(this).attr("mo-hint");i==t&&$(this).val("")}).keydown(function(i){return 13==i.keyCode?($.isFunction(window.doSearch)&&doSearch(),!1):void 0})},getMoInputVal:function(i){var t=$(i).attr("mo-hint");return t?$(i).val()!=t?$(i).val():"":$(i).val()},getUrl:function(i){if(!this.baseUrl)return i;var t=this.baseUrl.charAt(this.baseUrl.length-1);return"/"==t?this.baseUrl.substring(0,this.baseUrl.length-1)+i:this.baseUrl+i},doOpen:function(i){Mo.SubFrame.controller.setDetailFrame(this.getUrl("/"+i))},reinit:function(i){this.datagridOptions=null,this.initOptions(i),this.initDatagrid(),this.initHint(".input-text")},load:function(){Mo.SubFrame.controller.hideDetail(),$(this.datagridId).datagrid("load")},reload:function(){Mo.SubFrame.controller.hideDetail(),$(this.datagridId).datagrid("reload")},loadTreegrid:function(){Mo.SubFrame.controller.hideDetail(),$(this.treegridId).treegrid("load")},reloadTreegrid:function(){Mo.SubFrame.controller.hideDetail(),$(this.treegridId).treegrid("reload")}};