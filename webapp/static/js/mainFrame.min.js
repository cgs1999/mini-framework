$.namespace("Mo.Frame"),Mo.Frame={default_detail_paddingTop:56,default_detail_paddingLeft:244,detail_paddingTop:this.default_detail_paddingTop,detail_paddingLeft:this.default_detail_paddingLeft,main_min_width:1256,main_padding_left:128,main_min_height:400,main_padding_bottom:68,main_top_height:98,fixLineHeight:2,init:function(){this.setSize(),this.initEvent()},initEvent:function(){var i=this;$(window).resize(function(){i.setSize()})},setSize:function(){var i=this.getWindowSize();i.w<this.main_min_width&&(i.w=this.main_min_width),i.h<this.main_min_height;var e=i.w-2*this.main_padding_left;i.h,$(".wrap-all").width(e),$(".wrap-all").height(i.h);var t=i.h-this.main_top_height-this.main_padding_bottom;$("#inner-main").height(t);var n=t-2*this.fixLineHeight;$("#main-content").height(n),$("#detail-content").css("top",this.detail_paddingTop+this.fixLineHeight),$("#detail-content").height(n-this.detail_paddingTop);var a=$("#main-content").width()-this.detail_paddingLeft;$("#detail-content").width(a)},getWindowSize:function(){var i=$(window).width(),e=$(window).height();return{w:i,h:e}},getSideW:function(){return $("#aside").outerWidth()}},Mo.Frame.controller={mainFrameTag:"main-frame",detailFrameTag:"detail-frame",showHideTime:200,init:function(){this.initEvent()},initEvent:function(){var i=this;$("#e-bn-fold").click(function(){i.hideDetail()})},initUrlFilter:function(){this.mainUrlFilter(),this.detailUrlFilter()},mainUrlFilter:function(){var i=this;$(document).on("click","a[target='"+this.mainFrameTag+"']",function(){var e=$(this).attr("href");return e&&i.setMainFrame(e),!1})},detailUrlFilter:function(){var i=this;$(document).on("click","a[target='"+this.detailFrameTag+"']",function(){var e=$(this).attr("href");return e&&i.setDetailFrame(e,Mo.Frame.detail_paddingTop,Mo.Frame.detail_paddingLeft),!1})},fiterFrameURL:function(i){return"#"==i?!1:i},setMainFrame:function(i){i=this.fiterFrameURL(i),i&&($("#main-frame")[0].src=i),this.hideDetail()},setDetailFrame:function(i,e,t){i=this.fiterFrameURL(i),i&&($("#detail-frame")[0].src=i,this.showDetail(e,t))},getMainFrame:function(){return $("#main-frame")[0]},getDetailFrame:function(){return $("#detail-frame")[0]},callMainFrameFn:function(i){var e=this.getMainFrame().contentWindow;"function"==typeof e[i]&&e[i]()},callDetailFrameFn:function(i){var e=this.getDetailFrame().contentWindow;"function"==typeof e[i]&&e[i]()},showDetail:function(i,e){i=i||Mo.Frame.detail_paddingTop,e=e||Mo.Frame.detail_paddingLeft,(Mo.Frame.detail_paddingTop!=i||Mo.Frame.detail_paddingLeft!=e)&&this.setDetailSize(i,e),$("#detail-content").is(":visible")||$("#detail-content").stop(!0,!0).show().css("left",$("#inner-main").width()).animate({left:e},this.showHideTime)},setDetailSize:function(i,e){Mo.Frame.detail_paddingTop=i||Mo.Frame.default_detail_paddingTop,Mo.Frame.detail_paddingLeft=e||Mo.Frame.default_detail_paddingLeft,Mo.Frame.setSize()},hideDetail:function(){$("#detail-content").stop(!0,!0).animate({left:$("#inner-main").width()},this.showHideTime,function(){$(this).hide(),$("#detail-frame")[0].src="about:blank"})}},Mo.Frame.nav={init:function(){this.initEvent()},initEvent:function(){$(document).bind("click",function(i){var e=$(i.target);0==e.closest(".setting").length&&0==e.closest(".setting-list").length&&$(".setting-list","#header").hide()}),$(".setting","#header").bind("click",function(){$(".setting-list","#header").show()})}},$.namespace("Mo.Frame.aside"),Mo.Frame.aside={init:function(){this.initEvent()},initEvent:function(){var i=this;$(".aside-menu").on("click",".menu h3",function(){var i=$(this).parent(".menu");if(!i.hasClass(".selected")){$(".aside-menu .menu.selected").removeClass("selected"),i.addClass("selected");var e=$("li:first",i);e.click(),e.find("a").click()}}),$(".aside-menu").on("click",".menu li",function(){i.selectedLi($(this))})},selectedLi:function(i){i.hasClass(".selected")||($(".aside-menu li.selected").removeClass("selected"),i.addClass("selected"))}},$.namespace("Mo.Home"),Mo.Home={init:function(){Mo.Frame.init(),Mo.Frame.controller.init(),Mo.Frame.controller.initUrlFilter(),Mo.Frame.nav.init(),Mo.Frame.aside.init(),Mo.Home.asideMenu.init(),Mo.Home.modifyUser.init(),Mo.Home.modifyPassword.init(),Mo.Home.exit.init(),Mo.Home.about.init()}},Mo.Home.asideMenu={init:function(){this.initMenu(),this.initEvent()},initMenu:function(){for(var i=Mo.Menu.allMenus,e="",t=this.getRootMenus(i),n=t.length,a=0;n>a;a++){var o=this.getSubMenus(i,t[a].id),r=o.length;if(e+='<div class="menu">',e+="<h3><span>"+t[a].name+"</span><s>"+r+"</s></h3>",e+="<ul>",r>0)for(var s=0;r>s;s++)e+='<li><a href="'+Mo.Base.getAppUrl()+o[s].url+'" target="main-frame">'+o[s].name+"</a></li>";e+="</ul>",e+="</div>"}$("#divAsideMenu").html(e)},initEvent:function(){},getRootMenus:function(i){return this.getSubMenus(i,Mo.Menu.rootMenuId)},getSubMenus:function(i,e){var t=[],n=i.length;if(n>0)for(var a=0;n>a;a++)i[a].parentId==e&&(t[t.length]=i[a]);return t},loadMainFrame:function(i){Mo.Frame.controller.hideDetail(),Mo.Frame.controller.setMainFrame(Mo.Config.appUrl+i)}},Mo.Home.modifyUser={init:function(){this.initEvent()},initEvent:function(){var i=this;$("#modifyUser").bind("click",function(){$.dialog({padding:0,id:"modifyUserWindow",lock:!0,opacity:.5,content:document.getElementById("modifyUserWrapper"),close:function(){i.hideMsg(),$("#account").val($("#oldAccount").val()),$("#mobile").val($("#oldMobile").val()),$("#email").val($("#oldEmail").val()),$("#officeLocation").val($("#oldOfficeLocation").val())},cancel:!1,drag:!1})}),$(".confirm","#modifyUserWrapper").bind("click",function(){i.hideMsg();var e=i.checkData();return 0==e?!1:($.ajax({type:"post",url:Mo.Base.getAppUrl()+"/system/user/updateUser",data:e,dataType:"json",success:function(e){e.success&&($("#oldAccount").val($("#account").val()),$("#oldMobile").val($("#mobile").val()),$("#oldEmail").val($("#email").val()),$("#oldOfficeLocation").val($("#officeLocation").val())),i.showMsg(e.description)},error:function(){i.showMsg("修改个人资料失败，请与系统管理员联系！")}}),void 0)}),$(".W_close","#modifyUserWrapper").bind("click",function(){i.close()}),$(".cancel","#modifyUserWrapper").bind("click",function(){i.close()})},close:function(){$.dialog({id:"modifyUserWindow"}).close()},checkData:function(){var i={account:$("#account").val(),mobile:$("#mobile").val(),email:$("#email").val(),officeLocation:$("#officeLocation").val()};return""==$.trim(i.account)?(this.showMsg("请输入账号。"),$("#account").focus(),!1):""==$.trim(i.mobile)?(this.showMsg("请输入联系电话。"),$("#mobile").focus(),!1):""==$.trim(i.email)?(this.showMsg("请输入Email。"),$("#email").focus(),!1):""==$.trim(i.officeLocation)?(this.showMsg("请输入联系地址。"),$("#officeLocation").focus(),!1):i},showMsg:function(i){$(".msg","#modifyUserWrapper").text(i),$(".item-msg","#modifyUserWrapper").show()},hideMsg:function(){$(".item-msg","#modifyUserWrapper").hide(),$(".msg","#modifyUserWrapper").text("")}},Mo.Home.modifyPassword={init:function(){this.initEvent()},initEvent:function(){var i=this;$("#modifyPassword").bind("click",function(){$.dialog({padding:0,id:"modifyPasswordWindow",lock:!0,opacity:.5,title:"修改密码",content:document.getElementById("modifyPasswordWrapper"),close:function(){$("#oldPassword").val(""),$("#newPassword").val(""),$("#confirmPassword").val(""),i.hideMsg()},cancel:!1,drag:!1})}),$(".confirm","#modifyPasswordWrapper").bind("click",function(){i.hideMsg();var e=i.checkData();return 0==e?!1:($.ajax({type:"post",url:Mo.Base.getAppUrl()+"/system/user/updatePassword",data:e,dataType:"json",success:function(e){i.showMsg(e.description)},error:function(){}}),void 0)}),$(".W_close","#modifyPasswordWrapper").bind("click",function(){i.close()}),$(".cancel","#modifyPasswordWrapper").bind("click",function(){i.close()})},close:function(){$.dialog({id:"modifyPasswordWindow"}).close()},checkData:function(){var i={moid:"kedacom",oldPassword:$("#oldPassword").val(),newPassword:$("#newPassword").val(),confirmPassword:$("#confirmPassword").val()};return""==$.trim(i.oldPassword)?(this.showMsg("当前密码不能为空，请输入当前密码。"),$("#oldPassword").focus(),!1):""==$.trim(i.newPassword)?(this.showMsg("新密码不能为空，请输入新密码。"),$("#newPassword").focus(),!1):i.newPassword.length<6||i.newPassword.length>16?(this.showMsg("新密码不符合要求！"),$("#newPassword").focus(),!1):$.trim(i.oldPassword)==$.trim(i.newPassword)?(this.showMsg("新密码不能与旧密码一致"),$("#newPassword").focus(),!1):$.trim(i.newPassword)!=$.trim(i.confirmPassword)?(this.showMsg("两次输入密码不一致，请重新输入。"),$("#confirmPassword").focus(),!1):i},showMsg:function(i){$(".msg","#modifyPasswordWrapper").text(i),$(".item-msg","#modifyPasswordWrapper").show()},hideMsg:function(){$(".item-msg","#modifyPasswordWrapper").hide(),$(".msg","#modifyPasswordWrapper").text("")}},Mo.Home.exit={init:function(){this.initEvent()},initEvent:function(){var i=this;$(".logout","#header").bind("click",function(){$.dialog({padding:0,id:"logoutWindow",content:document.getElementById("logoutWrapper"),lock:!0,opacity:.5,cancel:!1,drag:!1})}),$(".W_close","#logoutWrapper").bind("click",function(){i.close()}),$(".cancel","#logoutWrapper").bind("click",function(){i.close()}),$(".confirm","#logoutWrapper").bind("click",function(){return location.href=Mo.Base.getAppUrl()+"/logout",!1})},close:function(){$.dialog({id:"logoutWindow"}).close()}},Mo.Home.about={init:function(){this.initEvent()},initEvent:function(){var i=this;$("#about").bind("click",function(){$.dialog({padding:0,id:"aboutWindow",content:document.getElementById("aboutWrapper"),lock:!0,opacity:.5,cancel:!1,drag:!1})}),$(".W_close","#aboutWrapper").bind("click",function(){i.close()})},close:function(){$.dialog({id:"aboutWindow"}).close()}};